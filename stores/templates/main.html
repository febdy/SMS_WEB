{% extends "base.html" %}

{% block css %}
    <style type="text/css">
        .box { width:50px; border:1px solid; padding:10px; text-align: center; display: inline-block;}
    </style>
{% endblock %}

{% block content %}

    <h1>{{ store_name }}</h1> <p>

    table status :

    <div id = "check_status">
        {% for table in table_status %}
            {{ table }}

        {% endfor %}
    </div>

    <p>

    <div class="tables" id="tables">
        <div class="box" id="table_1"> 1 </div>
        <div class="box" id="table_2"> 2 </div>
        <div class="box" id="table_3"> 3 </div>
        <div class="box" id="table_4"> 4 </div>
        <div class="box" id="table_5"> 5 </div>
        <div class="box" id="table_6"> 6 </div>
        <div class="box" id="test"> test </div>
    </div>

    <p>

    <Button id="btn_test">TEST</Button>

{% endblock %}

{% block javascript %}
    <script>
        $('document').ready(function(){
            function setTableNum(num){
                var table_num = "table_" + num;
                var table = document.getElementById(table_num);

                return table;
            }

            function setTableStatus(table_status){
                var bg_color;

                for(var i=0 ; i<=table_status.length ; i++){
                    if(table_status[i] == 0)
                        bg_color='rgb(124, 252, 000)';
                    else if(table_status[i] == 1)
                        bg_color='rgb(255, 000, 000)';
                    else
                        bg_color='rgb(255, 000, 000)';

                    var table = setTableNum(i+1);
                    setColor(table, bg_color);

                }
            }

            function setColor(table, bg_color){
                table.style.backgroundColor = bg_color;
            }

            setInterval(function(){
                $.ajax({
                    datatype:'json',
                    url:'{% url 'home' %}',
                    success: function(data) {
                        table_status = data.table_status;
                        setTableStatus(table_status);
                    },
                    error: function(error) {
                        console.log(error);
                    }
                });
            }, 2000);
        });
    </script>

{% endblock %}